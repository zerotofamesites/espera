<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Lista de Espera</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 215, 0, 0.05) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 25%, #2d2d2d 50%, #1a1a1a 75%, #0a0a0a 100%);
            background-size: 100% 100%, 100% 100%, 100% 100%, 100% 100%;
            background-attachment: fixed;
            color: #fff;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 98px,
                    rgba(255, 215, 0, 0.03) 100px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 98px,
                    rgba(255, 215, 0, 0.03) 100px
                );
            pointer-events: none;
            z-index: -1;
        }

        body::after {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle, rgba(255, 215, 0, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #000 0%, #333 100%);
            border-radius: 15px;
            border: 2px solid #ffd700;
        }

        .logo {
            width: 140px;
            height: 140px;
            margin: 0 auto 20px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #ffd700;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 90%;
            height: 90%;
            object-fit: contain;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffd700;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #ccc;
            margin-top: 10px;
        }

        .form-section {
            background: rgba(0,0,0,0.7);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #ffd700;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 2fr 1.5fr 1.5fr auto;
            gap: 15px;
            align-items: end;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #333;
            border-radius: 8px;
            background: #1a1a1a;
            color: #fff;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #ffd700;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: #fff;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.4);
        }

        .list-section {
            background: rgba(0,0,0,0.7);
            border-radius: 15px;
            border: 1px solid #ffd700;
            overflow: hidden;
        }

        .list-header {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #000;
            padding: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
        }

        .list-item {
            display: grid;
            grid-template-columns: 60px 1fr 2.5fr 150px 120px auto auto;
            gap: 15px;
            padding: 15px 20px;
            border-bottom: 1px solid #333;
            align-items: center;
            transition: background 0.3s;
        }

        .list-item:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .position {
            background: #ffd700;
            color: #000;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .name {
            font-weight: bold;
            color: #ffd700;
        }

        .date-info {
            font-size: 0.9rem;
            color: #ccc;
        }



        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-align: center;
        }

        .status.active {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid #28a745;
        }

        .status.warning {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid #ffc107;
        }

        .status.expired {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid #dc3545;
        }

        .whatsapp-btn {
            background: #25d366;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: bold;
            transition: all 0.3s;
        }

        .whatsapp-btn:hover {
            background: #128c7e;
            transform: scale(1.05);
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .delete-btn:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0,0,0,0.5);
        }

        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .alert.success {
            background: #28a745;
        }

        .alert.warning {
            background: #ffc107;
            color: #000;
        }

        .alert.error {
            background: #dc3545;
        }

        .alert.urgent {
            background: #ff4757;
            border: 2px solid #ffd700;
            animation: pulse 1s infinite;
            font-size: 1.1rem;
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.5);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .urgent-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .urgent-modal-content {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #ffd700;
            text-align: center;
            max-width: 500px;
            animation: bounce 0.5s ease;
        }

        .urgent-modal h2 {
            color: #fff;
            margin: 0 0 20px 0;
            font-size: 1.8rem;
        }

        .urgent-modal p {
            color: #fff;
            font-size: 1.2rem;
            margin: 10px 0;
        }

        .urgent-modal .person-name {
            color: #ffd700;
            font-weight: bold;
            font-size: 1.4rem;
        }

        .urgent-modal button {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes bounce {
            0% { transform: scale(0.3); }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .list-item {
                grid-template-columns: 1fr;
                gap: 10px;
                text-align: center;
            }
            
            .title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjrAj-gZ6d2n0R_eJ8FUThVuOPFOZPGQfVNYSAyk2RVDtn7h5qOoXfw3cF0RZQNffUdILrj_uF9t9OxPIJxTyO5SMMsv2JheWaCjEZejmQCGaTtNo5OIfG8kxTdq0vnQMHbAUzHuB-JC_xlRZH5YWQVrHhJjc6ejrc4JkfLICK2Z_191iqkn2rnPp3wfbo7" alt="Logo" onerror="this.src=''; this.alt='Logo não disponível'; this.style.display='none';">
            </div>
            <h1 class="title">Lista de Espera</h1>
            <p class="subtitle">Gerenciamento Profissional de Candidatos</p>
        </div>

        <div class="form-section">
            <form id="waitingListForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="number">Número</label>
                        <input type="text" id="number" required>
                    </div>
                    <div class="form-group">
                        <label for="name">Nome Completo</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="interestDate">Data de Entrada</label>
                        <input type="date" id="interestDate" required>
                    </div>
                    <div class="form-group">
                        <label for="exitDate">Data de Saída</label>
                        <input type="date" id="exitDate" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">Adicionar</button>
                    </div>
                </div>
            </form>
        </div>

        <div class="list-section">
            <div class="list-header">
                Lista de Candidatos
            </div>
            <div id="waitingList">
                <div class="empty-state">
                    <p>Nenhum candidato na lista de espera</p>
                </div>
            </div>
            <div class="controls">
                <div>
                    <span id="totalCount">Total: 0 candidatos</span>
                </div>
                <button id="clearList" class="btn btn-danger">Zerar Lista</button>
            </div>
        </div>
    </div>

    <script>
        class WaitingListManager {
            constructor() {
                this.list = JSON.parse(localStorage.getItem('waitingList')) || [];
                this.persistentAlertInterval = null;
                this.audioContext = null;
                this.init();
                this.checkDates();
                setInterval(() => this.checkDates(), 60000); // Verifica a cada minuto
            }

            init() {
                this.renderList();
                this.bindEvents();
                this.setMinDate();
            }

            setMinDate() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('interestDate').min = today;
                document.getElementById('exitDate').min = today;
                
                // Adiciona evento para validar que data de saída seja após data de entrada
                document.getElementById('interestDate').addEventListener('change', (e) => {
                    const entryDate = e.target.value;
                    if (entryDate) {
                        document.getElementById('exitDate').min = entryDate;
                    }
                });
            }

            bindEvents() {
                document.getElementById('waitingListForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addPerson();
                });

                document.getElementById('clearList').addEventListener('click', () => {
                    this.clearList();
                });
            }

            addPerson() {
                const number = document.getElementById('number').value.trim();
                const name = document.getElementById('name').value.trim();
                const interestDate = document.getElementById('interestDate').value;
                const exitDate = document.getElementById('exitDate').value;

                if (!number || !name || !interestDate || !exitDate) {
                    this.showAlert('Preencha todos os campos', 'error');
                    return;
                }

                // Validação: data de saída deve ser após data de entrada
                if (exitDate <= interestDate) {
                    this.showAlert('A data de saída deve ser posterior à data de entrada', 'error');
                    return;
                }

                const person = {
                    id: Date.now(),
                    number,
                    name,
                    interestDate,
                    exitDate,
                    addedAt: new Date().toISOString()
                };

                this.list.push(person);
                this.saveList();
                this.renderList();
                this.clearForm();
                this.showAlert('Pessoa adicionada com sucesso!', 'success');
            }

            clearForm() {
                document.getElementById('waitingListForm').reset();
            }

            clearList() {
                if (confirm('Tem certeza que deseja zerar a lista? Esta ação não pode ser desfeita.')) {
                    this.list = [];
                    this.saveList();
                    this.renderList();
                    this.showAlert('Lista zerada com sucesso!', 'success');
                }
            }

            deletePerson(personId) {
                if (confirm('Tem certeza que deseja remover esta pessoa da lista?')) {
                    this.list = this.list.filter(person => person.id !== personId);
                    this.saveList();
                    this.renderList();
                    this.showAlert('Pessoa removida com sucesso!', 'success');
                }
            }

            saveList() {
                localStorage.setItem('waitingList', JSON.stringify(this.list));
            }

            getPersonStatus(interestDate) {
                const now = new Date();
                const today = now.toISOString().split('T')[0]; // Data atual no formato YYYY-MM-DD
                const interestDateStr = interestDate; // Mantém como string
                
                // Compara diretamente as strings de data
                if (interestDateStr < today) {
                    return { status: 'expired', text: 'Expirado', class: 'expired' };
                } else if (interestDateStr === today) {
                    return { status: 'warning', text: 'Hoje', class: 'warning' };
                } else {
                    // Calcula diferença em dias
                    const interestDateObj = new Date(interestDateStr + 'T12:00:00'); // Meio-dia para evitar problemas de fuso
                    const todayObj = new Date(today + 'T12:00:00');
                    const diffTime = interestDateObj.getTime() - todayObj.getTime();
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays === 1) {
                        return { status: 'warning', text: 'Amanhã', class: 'warning' };
                    } else if (diffDays <= 2) {
                        return { status: 'warning', text: `${diffDays} dias`, class: 'warning' };
                    } else {
                        return { status: 'active', text: `${diffDays} dias`, class: 'active' };
                    }
                }
            }

            checkDates() {
                const now = new Date();
                const today = now.toISOString().split('T')[0]; // Data atual no formato YYYY-MM-DD
                let hasExpired = false;
                let hasWarnings = false;
                let urgentReservations = [];
                let todayReservations = [];

                this.list = this.list.filter(person => {
                    const interestDateStr = person.interestDate; // Mantém como string
                    
                    // Compara diretamente as strings de data
                    if (interestDateStr < today) {
                        hasExpired = true;
                        return false; // Remove pessoas com data expirada
                    } else if (interestDateStr === today) {
                        // Mesmo dia da reserva
                        todayReservations.push(person);
                        hasWarnings = true;
                    } else {
                        // Calcula diferença em dias
                        const interestDate = new Date(interestDateStr + 'T12:00:00'); // Meio-dia para evitar problemas de fuso
                        const todayDate = new Date(today + 'T12:00:00');
                        const diffTime = interestDate.getTime() - todayDate.getTime();
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        if (diffDays === 1) {
                            // Reserva para amanhã
                            urgentReservations.push(person);
                            hasWarnings = true;
                        } else if (diffDays <= 2) {
                            hasWarnings = true;
                        }
                    }
                    return true;
                });

                if (hasExpired) {
                    this.saveList();
                    this.renderList();
                    this.showAlert('Registros expirados foram removidos automaticamente', 'warning');
                }

                if (todayReservations.length > 0) {
                    this.showTodayAlert(todayReservations);
                } else if (urgentReservations.length > 0) {
                    this.showUrgentAlert(urgentReservations);
                } else if (hasWarnings) {
                    this.showAlert('Atenção: Alguns registros estão próximos do vencimento!', 'warning');
                }
            }

            generateWhatsAppLink(person) {
                const gender = this.detectGender(person.name);
                const pronoun = gender === 'female' ? 'senhora' : 'senhor';
                const article = gender === 'female' ? 'a' : 'o';
                
                const entryDate = this.formatDateDDMMYY(person.interestDate);
                const exitDate = this.formatDateDDMMYY(person.exitDate);
                
                const message = `Olá ${person.name}! Verificamos em nosso sistema que ${article} ${pronoun} encontra-se atualmente na nossa lista de espera para o período de ${entryDate} até ${exitDate}. Gostaríamos de saber se ${article} ${pronoun} ainda tem interesse em continuar.`;
                
                const encodedMessage = encodeURIComponent(message);
                return `https://wa.me/55${person.number.replace(/\D/g, '')}?text=${encodedMessage}`;
            }

            detectGender(name) {
                const femaleEndings = ['a', 'ana', 'ina', 'lia', 'ria', 'ela', 'isa', 'osa'];
                const maleEndings = ['o', 'os', 'or', 'er', 'ar'];
                
                const lowerName = name.toLowerCase();
                
                // Verifica terminações femininas
                for (let ending of femaleEndings) {
                    if (lowerName.endsWith(ending)) {
                        return 'female';
                    }
                }
                
                // Verifica terminações masculinas
                for (let ending of maleEndings) {
                    if (lowerName.endsWith(ending)) {
                        return 'male';
                    }
                }
                
                // Default para masculino se não conseguir detectar
                return 'male';
            }

            formatDateDDMMYY(dateInput) {
                let date;
                if (typeof dateInput === 'string') {
                    // Se for string no formato YYYY-MM-DD, converte para Date
                    date = new Date(dateInput + 'T12:00:00');
                } else {
                    // Se já for um objeto Date
                    date = dateInput;
                }
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = String(date.getFullYear()).slice(-2);
                return `${day}/${month}/${year}`;
            }

            renderList() {
                const container = document.getElementById('waitingList');
                const totalCount = document.getElementById('totalCount');

                if (this.list.length === 0) {
                    container.innerHTML = '<div class="empty-state"><p>Nenhum candidato na lista de espera</p></div>';
                    totalCount.textContent = 'Total: 0 candidatos';
                    return;
                }

                // Ordena a lista por urgência (data de interesse mais próxima primeiro)
                const sortedList = [...this.list].sort((a, b) => {
                    const dateA = new Date(a.interestDate);
                    const dateB = new Date(b.interestDate);
                    return dateA.getTime() - dateB.getTime();
                });

                const html = sortedList.map((person, index) => {
                    const statusInfo = this.getPersonStatus(person.interestDate);
                    const whatsappLink = this.generateWhatsAppLink(person);
                    const addedDate = this.formatDateDDMMYY(new Date(person.addedAt));
                    const interestDateFormatted = this.formatDateDDMMYY(person.interestDate);
                    const exitDateFormatted = person.exitDate ? this.formatDateDDMMYY(person.exitDate) : 'Não informado';
                    
                    // Calcula quantos dias de estadia
                    const entryDate = new Date(person.interestDate + 'T12:00:00');
                    const exitDate = new Date(person.exitDate + 'T12:00:00');
                    const diffTime = exitDate.getTime() - entryDate.getTime();
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                    return `
                        <div class="list-item">
                            <div class="position">${index + 1}</div>
                            <div class="name">${person.name}</div>
                            <div class="date-info">
                                <div>Entrada: ${interestDateFormatted}</div>
                                <div>Saída: ${exitDateFormatted}</div>
                                <div>Período: ${diffDays} dia${diffDays !== 1 ? 's' : ''}</div>
                                <div>Tel: ${person.number}</div>
                                <div>Adicionado: ${addedDate}</div>
                            </div>
                            <div class="status ${statusInfo.class}">${statusInfo.text}</div>
                            <a href="${whatsappLink}" target="_blank" rel="noopener noreferrer" class="whatsapp-btn">
                                📱 WhatsApp
                            </a>
                            <button class="delete-btn" onclick="waitingListManager.deletePerson(${person.id})">
                                🗑️ Excluir
                            </button>
                        </div>
                    `;
                }).join('');

                container.innerHTML = html;
                totalCount.textContent = `Total: ${this.list.length} candidatos`;
            }

            showAlert(message, type) {
                const alert = document.createElement('div');
                alert.className = `alert ${type}`;
                alert.textContent = message;
                document.body.appendChild(alert);

                setTimeout(() => {
                    alert.remove();
                }, 4000);
            }

            playAlertSound() {
                // Cria um som de alerta usando Web Audio API
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Primeira nota (mais aguda)
                const oscillator1 = audioContext.createOscillator();
                const gainNode1 = audioContext.createGain();
                
                oscillator1.connect(gainNode1);
                gainNode1.connect(audioContext.destination);
                
                oscillator1.frequency.setValueAtTime(800, audioContext.currentTime);
                gainNode1.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode1.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator1.start(audioContext.currentTime);
                oscillator1.stop(audioContext.currentTime + 0.5);
                
                // Segunda nota (mais grave) - após um pequeno delay
                setTimeout(() => {
                    const oscillator2 = audioContext.createOscillator();
                    const gainNode2 = audioContext.createGain();
                    
                    oscillator2.connect(gainNode2);
                    gainNode2.connect(audioContext.destination);
                    
                    oscillator2.frequency.setValueAtTime(600, audioContext.currentTime);
                    gainNode2.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator2.start(audioContext.currentTime);
                    oscillator2.stop(audioContext.currentTime + 0.5);
                }, 200);
                
                // Terceira nota (ainda mais grave) - para completar o alerta
                setTimeout(() => {
                    const oscillator3 = audioContext.createOscillator();
                    const gainNode3 = audioContext.createGain();
                    
                    oscillator3.connect(gainNode3);
                    gainNode3.connect(audioContext.destination);
                    
                    oscillator3.frequency.setValueAtTime(400, audioContext.currentTime);
                    gainNode3.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode3.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.7);
                    
                    oscillator3.start(audioContext.currentTime);
                    oscillator3.stop(audioContext.currentTime + 0.7);
                }, 400);
            }

            startPersistentAlert() {
                // Para qualquer alerta anterior
                this.stopPersistentAlert();
                
                // Toca o som imediatamente
                this.playUrgentSound();
                
                // Configura para tocar a cada 10 segundos
                this.persistentAlertInterval = setInterval(() => {
                    this.playUrgentSound();
                }, 10000);
            }

            stopPersistentAlert() {
                if (this.persistentAlertInterval) {
                    clearInterval(this.persistentAlertInterval);
                    this.persistentAlertInterval = null;
                }
            }

            playUrgentSound() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Som mais urgente e chamativo para reservas de hoje
                    const frequencies = [1000, 800, 1200, 600, 1400];
                    
                    frequencies.forEach((freq, index) => {
                        setTimeout(() => {
                            const oscillator = this.audioContext.createOscillator();
                            const gainNode = this.audioContext.createGain();
                            
                            oscillator.connect(gainNode);
                            gainNode.connect(this.audioContext.destination);
                            
                            oscillator.frequency.setValueAtTime(freq, this.audioContext.currentTime);
                            oscillator.type = 'square'; // Som mais chamativo
                            gainNode.gain.setValueAtTime(0.4, this.audioContext.currentTime);
                            gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.3);
                            
                            oscillator.start(this.audioContext.currentTime);
                            oscillator.stop(this.audioContext.currentTime + 0.3);
                        }, index * 150);
                    });
                } catch (error) {
                    console.log('Áudio não suportado neste navegador');
                }
            }

            showTodayAlert(todayReservations) {
                // Verifica se já existe um alerta ativo para hoje
                if (document.querySelector('.today-alert-modal')) {
                    return;
                }

                // Inicia o som persistente
                this.startPersistentAlert();
                
                // Cria o modal de alerta para hoje
                const modal = document.createElement('div');
                modal.className = 'urgent-modal today-alert-modal';
                
                const content = document.createElement('div');
                content.className = 'urgent-modal-content';
                content.style.background = 'linear-gradient(135deg, #ff1744 0%, #d50000 100%)';
                content.style.animation = 'pulse 0.8s infinite';
                
                const title = document.createElement('h2');
                title.textContent = '🔥 RESERVA PARA HOJE! 🔥';
                title.style.fontSize = '2rem';
                
                const subtitle = document.createElement('p');
                subtitle.textContent = 'Atenção! Reserva(s) para hoje:';
                subtitle.style.fontSize = '1.3rem';
                
                content.appendChild(title);
                content.appendChild(subtitle);
                
                todayReservations.forEach(person => {
                    const personDiv = document.createElement('p');
                    personDiv.innerHTML = `<span class="person-name" style="font-size: 1.5rem;">${person.name}</span><br>Data: HOJE (${this.formatDateDDMMYY(person.interestDate)})<br>Tel: ${person.number}`;
                    personDiv.style.margin = '20px 0';
                    personDiv.style.padding = '15px';
                    personDiv.style.background = 'rgba(255, 255, 255, 0.1)';
                    personDiv.style.borderRadius = '10px';
                    content.appendChild(personDiv);
                });

                const questionDiv = document.createElement('div');
                questionDiv.style.margin = '30px 0 20px 0';
                questionDiv.style.fontSize = '1.2rem';
                questionDiv.style.fontWeight = 'bold';
                questionDiv.textContent = 'Já entrou em contato com esta pessoa?';
                
                const buttonContainer = document.createElement('div');
                buttonContainer.style.display = 'flex';
                buttonContainer.style.gap = '15px';
                buttonContainer.style.justifyContent = 'center';
                
                const yesBtn = document.createElement('button');
                yesBtn.textContent = 'SIM, JÁ CONTATEI';
                yesBtn.style.background = '#4caf50';
                yesBtn.style.color = 'white';
                yesBtn.style.padding = '15px 25px';
                yesBtn.style.fontSize = '1.1rem';
                yesBtn.style.fontWeight = 'bold';
                yesBtn.style.border = 'none';
                yesBtn.style.borderRadius = '8px';
                yesBtn.style.cursor = 'pointer';
                yesBtn.onclick = () => {
                    this.stopPersistentAlert();
                    modal.remove();
                    this.showAlert('Contato confirmado! Alerta desativado.', 'success');
                };
                
                const noBtn = document.createElement('button');
                noBtn.textContent = 'NÃO, AINDA NÃO';
                noBtn.style.background = '#f44336';
                noBtn.style.color = 'white';
                noBtn.style.padding = '15px 25px';
                noBtn.style.fontSize = '1.1rem';
                noBtn.style.fontWeight = 'bold';
                noBtn.style.border = 'none';
                noBtn.style.borderRadius = '8px';
                noBtn.style.cursor = 'pointer';
                noBtn.onclick = () => {
                    modal.remove();
                    this.showAlert('Lembre-se de entrar em contato! O alerta continuará.', 'warning');
                    // Reagenda o alerta para aparecer novamente em 5 minutos
                    setTimeout(() => {
                        this.showTodayAlert(todayReservations);
                    }, 300000); // 5 minutos
                };
                
                buttonContainer.appendChild(yesBtn);
                buttonContainer.appendChild(noBtn);
                
                content.appendChild(questionDiv);
                content.appendChild(buttonContainer);
                modal.appendChild(content);
                document.body.appendChild(modal);
            }

            showUrgentAlert(urgentReservations) {
                // Toca o som de alerta
                this.playAlertSound();
                
                // Cria o modal de alerta urgente
                const modal = document.createElement('div');
                modal.className = 'urgent-modal';
                
                const content = document.createElement('div');
                content.className = 'urgent-modal-content';
                
                const title = document.createElement('h2');
                title.textContent = '🚨 ALERTA URGENTE! 🚨';
                
                const subtitle = document.createElement('p');
                subtitle.textContent = 'Reserva(s) vencendo em 1 dia:';
                
                content.appendChild(title);
                content.appendChild(subtitle);
                
                urgentReservations.forEach(person => {
                    const personDiv = document.createElement('p');
                    personDiv.innerHTML = `<span class="person-name">${person.name}</span><br>Data: ${this.formatDateDDMMYY(person.interestDate)}<br>Tel: ${person.number}`;
                    content.appendChild(personDiv);
                });
                
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'Entendi';
                closeBtn.onclick = () => {
                    modal.remove();
                };
                
                content.appendChild(closeBtn);
                modal.appendChild(content);
                document.body.appendChild(modal);
                
                // Remove o modal automaticamente após 10 segundos
                setTimeout(() => {
                    if (modal.parentNode) {
                        modal.remove();
                    }
                }, 10000);
                
                // Também mostra um alerta normal
                this.showAlert(`🚨 ${urgentReservations.length} reserva(s) vencendo em 1 dia!`, 'urgent');
            }
        }

        // Inicializar o sistema
        const waitingListManager = new WaitingListManager();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'984b5a00b4a3f633',t:'MTc1ODgxMjAxMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
